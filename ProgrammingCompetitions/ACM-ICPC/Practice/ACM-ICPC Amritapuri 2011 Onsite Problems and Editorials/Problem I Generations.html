<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>Generations</title>
</head>
<body>
<h1 style="font-family: Arial;"><small>ACM International Collegiate
Programming Contest, Asia-Amritapuri Site, 2011</small></h1>
<h2>Problem I: Generations</h2>
Harry's friend Charlie Weasley has partnered with an old-time breeder
of dragons in Romania.&nbsp; When Harry visited Charlie over the
summer, Charlie showed him breeding records stretching back
centuries.&nbsp; It had started out with just one female dragon
named Abraxia that had then reproduced to give many generations of
dragons.&nbsp; The breeding record showed a family tree of dragons,
starting with Abraxia and showing each descendant* (only females'
descendants were shown),&nbsp; the year each was hatched from its egg
and the year each died.&nbsp; Only already dead dragons were included.
Charlie pointed out that a dragon matured early, and once hatched,
could herself lay and
hatch an egg in the very year it was born.&nbsp; Dragon eggs did not
need a mother's care to hatch -- the breeders simply used the warmth of
a blowtorch to keep the egg warm and hatch it, sometimes long after the
mother dragon was dead.<br>
Harry noticed that sometimes many generations of dragons were alive at
the same time.&nbsp;&nbsp; He was curious to figure out, for each
dragon when it was alive, what was the maximum generational difference
(absolute value) between it and its coeval** descendants.&nbsp; Can you
help him?&nbsp;
Assume that if a dragon dies the year another is hatched, they
were coeval.<br>
<br>
*A descendant is a child, grandchild, great-grandchild etc.<br>
**coeval: Alive at the same time.<br>
<br>
<h3>Input (STDIN):</h3>
The first line contains the number of test cases T.<br>
The first line of each test case starts with an integer N - the number
of dragons.<br>
It is followed by N lines. The ith line (0 indexed) contains 3
integers, p_i, hatchyear_i and deathyear_i. p_i is the parent of ith
dragon and its interval is hatchyear_i to deathyear_i.&nbsp; The dragon
with index 0 is Abraxia, and a mother's index is smaller than all its
descendants'. <br>
<h3>Output (STDOUT):</h3>
Output T lines.<br>
Each line contains a space-separated list of N integers, the ith of
them denoting the required answer for the ith dragon. If the ith
dragon's life does not overlap with any descendant's, output 0 for that
dragon.<br>
<h3>Constraints:</h3>
1 &lt;= T &lt;= 3<br>
1 &lt;= N &lt;= 70000<br>
0 &lt;= hatchyear &lt;= deathyear &lt;= 10^9<br>
p_0 = -1<br>
For all i &gt; 0, 0 &lt;= p_i &lt; i<br>
hatchyear of dragon &gt;= hatchyear of its mother<br>
<br>
Time Limit: 3s<br>
Memory Limit: 64 MB<br>
<h3>Sample Input:</h3>
<span style="font-family: Courier New,Courier,monospace;">2</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">5</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">-1 0 10</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">0 1 5</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">0 2 8</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">0 2 5</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">3 10 12</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">9</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">-1 0 10</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">0 1 1</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">0 2 2</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">1 2 3</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">1 3 4</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">2 2 3</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">2 2 4</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">6 10 11</span><br
 style="font-family: Courier New,Courier,monospace;">
<span style="font-family: Courier New,Courier,monospace;">6 20 30</span><br>
<br>
<h3>Sample Output:</h3>
2 0 0 0 0<br>
3 0 1 0 0 0 0 0 0<br>
<br>
<br>
</body>
</html>
